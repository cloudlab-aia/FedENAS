# Fed-ENAS: Federated Efficient Neural Architecture Search

This repository contains the code and documentation for the paper:

**ğŸ“„ Breaking the Architecture Barrier in Federated Learning: A Federated Efficient NAS Approach**  
**ğŸ‘¨â€ğŸ”¬ Authors:** Tamai RamÃ­rez-Gordillo, Francisco A. Pujol, Higinio Mora  
**ğŸ› Affiliation:** Department of Computer Technology and Computation, University of Alicante  
**ğŸ“… Submission Date:** July 29, 2025  
**ğŸ“š Journal:** Neurocomputing *(preprint)*

---

## ğŸ§  Overview

**Fed-ENAS** is a novel framework combining **Federated Learning (FL)** with **Efficient Neural Architecture Search (ENAS)** to automatically design, adapt, and train personalised neural network architectures across decentralised clientsâ€”without sharing raw data.

### Key Contributions

- âœ… Personalised model architectures per client using local NAS.
- ğŸ” Modified `FedAvg` that handles architectural heterogeneity via weight-dictionary alignment.
- ğŸ”’ Preserves privacyâ€”no raw data or full architectures leave the device.
- ğŸ§ª Validated on CIFAR-10 under IID conditions, outperforming traditional FL approaches.

---

## ğŸ§ª Experimental Setup

### Dataset

- CIFAR-10 (60,000 images, 10 classes, 32Ã—32 RGB)
- Data split: 40K train / 10K validation / 10K test per client
- Augmentation: random crop, flip, normalisation

### Federated Configuration

| Parameter               | Value                     |
|-------------------------|---------------------------|
| Clients                 | 4                         |
| Epochs per client       | 20                        |
| Federated rounds        | 5                         |
| Optimizer               | SGD with momentum         |
| LR Scheduler            | Cosine annealing (0.05â†’0.005) |
| Data distribution       | IID                       |

---

## âš™ï¸ Installation & Usage

### Prerequisites

- Python 3.10+
- Docker 28.0.4+
- CUDA 12.8
- TensorFlow 2.19.0
- NVIDIA GPU
- Flower 1.19.0

### Installation Steps

```bash
# Clone the repository
git clone https://github.com/cloudlab-aia/FedENAS.git
cd fed-enas

# Build Docker container
docker build -t fedenas-env .

# To run the container you should modify the `run.sh` based on the image name and your GPU resources

### Run Federated Training
You should check how the Flower Simulations Engine works to run the experiments. If you need more information contact us.
```

---

## ğŸ“ˆ Results Summary

| Method           | Validation Acc | Test Acc | Total Time     |
|------------------|----------------|----------|----------------|
| **Fed-ENAS**     | **0.7529**     | **0.7424** | 3h 53m         |
| Fed-CNN Custom   | 0.6859         | 0.6808   | 6m 43s         |
| Fed-CNN LeNet    | 0.7114         | 0.6111   | 6m 15s         |
| Fed-CNN VGG19    | 0.6361         | 0.6352   | 21m 9s         |
| ENAS Custom      | 0.5428         | 0.5817   | 4h 49m         |

> ğŸ“Š Fed-ENAS significantly improves performance while adapting architectures to each client's data.

---

## ğŸ–¼ï¸ Visual Output

Fed-ENAS automatically discovers distinct architectures per client. Below is an example schematic generated by the LSTM controller for one client:

```
[Conv3x3] â†’ [DepthwiseSeparable5x5] â†’ [MaxPool3x3] â†’ [Conv5x5] â†’ ... â†’ [GlobalAvgPool] â†’ [Dense]
```

*Note: Visual diagrams can be generated using `graphviz` or `TensorBoard` from the final model.*

---

## âœï¸ How to Cite

If you use this work, please cite the original paper:

```bibtex
@article{ramirez2025fedenas,
  title     = {Breaking the Architecture Barrier in Federated Learning: A Federated Efficient NAS Approach},
  author    = {Tamai RamÃ­rez-Gordillo and Francisco A. Pujol and Higinio Mora},
  journal   = {Neurocomputing},
  year      = {2025},
  note      = {Preprint submitted July 29, 2025}
}
```

---

## ğŸ¤ Acknowledgements

This work was supported by:

- ğŸ‡ªğŸ‡¸ Spanish Research Agency (AEI), Project Serverless4HPC (PID2023-152804OB-I00)
- ğŸ‡ªğŸ‡º Generalitat Valenciana, CIACIF/2022/176, co-funded by European Social Fund Plus (ESF+)

---

## ğŸ“¬ Contact

For technical issues or collaboration proposals:

ğŸ“§ **tamai.ramirez@ua.es**  
ğŸ« University of Alicante  
ğŸŒ [https://www.ua.es](https://www.ua.es)

---
